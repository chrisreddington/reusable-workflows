name: Validate Dev Container Configuration
on:
  workflow_call:
    inputs:
      extensions-list:
        required: false
        type: string
        description: 'Comma-separated list of required VS Code extensions'
        default: 'GitHub.codespaces,github.vscode-github-actions,GitHub.copilot,GitHub.copilot-chat,github.copilot-workspace,GitHub.vscode-pull-request-github,GitHub.remotehub,GitHub.vscode-codeql'
      devcontainer-path:
        required: false
        type: string
        default: '.devcontainer/devcontainer.json'
        description: 'Path to devcontainer.json file'
      required-files:
          required: false
          type: string
          default: 'README.md, LICENSE, .gitignore, .github/copilot-instructions.md'
          description: 'Path to devcontainer.json file'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        name: "Checkout Repository"
      
      - uses: chrisreddington/validate-devcontainer@main
        name: "Validate Dev Container Configuration"
        if: always()
        with:
          extensions-list: ${{ inputs.extensions-list }}
          devcontainer-path: ${{ inputs.devcontainer-path }}
          validate-tasks: 'true'

      - uses: chrisreddington/validate-file-exists@main
        name: "Validate Required Files Exist"
        if: always()
        with:
          files: ${{ inputs.required-files }}
          
      - uses: chrisreddington/validate-dependabot@main
        name: "Validate Dependabot is configured for repository's languages"
        if: always()
